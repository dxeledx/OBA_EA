# 2026-01-01 — LOSO 4-class (BNCI2014_001) — FBCSP baseline attempt

Goal: try a **stronger classic MI baseline** (multi-band features) within the same protocol, to see whether it can clearly beat `ea-csp-lda` (mean acc ≈ 0.532 on this setup) and thus be a new family candidate for `ea-mm-safe`.

## Setup
- Dataset: MOABB `BNCI2014_001` (BCI IV-2a)
- Protocol: LOSO (cross-subject)
- Classes: `left_hand,right_hand,feet,tongue` (4-class)
- Sessions: `0train`
- Preprocess: `paper_fir` (causal FIR order=50, 8–30 Hz), epoch 0.5–3.5s, resample 250 Hz
- Metrics: macro avg

## Methods
- `ea-csp-lda`: per-subject EA whitening → CSP → LDA.
- `ea-fbcsp-lda`: EA whitening → **FilterBank-CSP** features (per-band, per-pair CSP; MI top-k) → LDA.
- `fbcsp-lda`: same as above but **without** EA whitening.

FBCSP implementation details (current):
- Bands (within 8–30 Hz): 8–12, 10–14, 12–16, …, 26–30 (width=4 Hz, step=2 Hz)
- Multi-class strategy: one-vs-one CSP per class pair (OVO) per band
- Feature selection: mutual information top-24 (`MI@24`)
- Classifier: LDA with shrinkage (`solver="lsqr", shrinkage="auto"`)

## Runs
### (A) EA vs EA-FBCSP
```bash
_MNE_FAKE_HOME_DIR=$PWD/.mne_home MNE_DATA=$PWD/.mne_data \
conda run -n eeg python run_csp_lda_loso.py \
  --dataset BNCI2014_001 --preprocess paper_fir \
  --events left_hand,right_hand,feet,tongue --sessions 0train \
  --n-components 6 \
  --methods ea-csp-lda,ea-fbcsp-lda \
  --no-plots \
  --run-name loso4_bnci2014_001_ea_fbcsp_ovo_mi
```
Outputs:
- `outputs/20260101/4class/loso4_bnci2014_001_ea_fbcsp_ovo_mi/20260101_method_comparison.csv`
- `outputs/20260101/4class/loso4_bnci2014_001_ea_fbcsp_ovo_mi/20260101_results.txt`

Key numbers (`20260101_method_comparison.csv`):
- `ea-csp-lda` mean acc: **0.5320**
- `ea-fbcsp-lda` mean acc: **0.5058** (Δ vs EA: **-0.0262**, neg-transfer-rate: **0.778**)

### (B) EA vs FBCSP (no EA whitening)
```bash
_MNE_FAKE_HOME_DIR=$PWD/.mne_home MNE_DATA=$PWD/.mne_data \
conda run -n eeg python run_csp_lda_loso.py \
  --dataset BNCI2014_001 --preprocess paper_fir \
  --events left_hand,right_hand,feet,tongue --sessions 0train \
  --n-components 6 \
  --methods ea-csp-lda,fbcsp-lda \
  --no-plots \
  --run-name loso4_bnci2014_001_fbcsp
```
Outputs:
- `outputs/20260101/4class/loso4_bnci2014_001_fbcsp/20260101_method_comparison.csv`
- `outputs/20260101/4class/loso4_bnci2014_001_fbcsp/20260101_results.txt`

Key numbers (`20260101_method_comparison.csv`):
- `ea-csp-lda` mean acc: **0.5320**
- `fbcsp-lda` mean acc: **0.3368** (Δ vs EA: **-0.1952**, neg-transfer-rate: **0.889**)

## Takeaway
On this **4-class LOSO BNCI2014_001** setup, the current FBCSP variants **do not beat** `ea-csp-lda` and thus are **not suitable as the “strong baseline / new family”** for `ea-mm-safe` under this protocol.

